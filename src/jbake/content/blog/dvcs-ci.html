title=GitFlow and Continuous Integration
date=2011-09-14
type=post
tags=artifactory, branching, continuous integration, dvcs, git, gitflow, github, gradle, Java, jenkins
status=published
~~~~~~
<p>I came across an <a title="James Carr - My Current Java Workflow" href="http://blog.james-carr.org/2011/09/09/my-current-java-workflow/" target="_blank">interesting blog post</a> by James Carr discussing his workflow when building Java applications.  In general, I think that the stack and process he mentions is top notch.  I love <a title="Gradle" href="http://www.gradle.org/" target="_blank">Gradle</a>, <a title="Jenkins" href="http://jenkins-ci.org/" target="_blank">Jenkins</a>, <a title="Artifactory" href="http://www.jfrog.com/products.php" target="_blank">Artifactory</a> and <a title="Git" href="http://git-scm.com/" target="_blank">Git</a>/<a title="GitHub" href="https://github.com/" target="_blank">GitHub</a>.  I have been playing with or using in production all of these tools and they are amazing.  I especially like how the article provides a tutorial on how to setup your project to look just like his, something I will definitely try.</p><p>Where the article raised questions for me was when James started talking about <a title="GitFlow" href="https://github.com/nvie/gitflow" target="_blank">GitFlow</a> and Vincent Driessen's <a title="Vincent Driessen's Git Branching Model" href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank">Git Branching Model</a>.  If you haven't read this article, I recommend you stop and go read it now.</p><p>Vincent's approach to using Git takes full advantage of a major feature provided in DVCS, <a title="Why git is better than X - Cheap Local Branching" href="http://whygitisbetterthanx.com/#cheap-local-branching" target="_blank">cheap local branching</a>.  As an advocate of <a title="Continuous Integration" href="http://martinfowler.com/articles/continuousIntegration.html" target="_blank">continuous integration</a> however, I have always recommended that one should avoid the approach of excessive branching.  One of the principle practices of continuous integration is:</p><blockquote><p>Everyone commits to the mainline everyday</p></blockquote><p>Martin Fowler goes on to say,</p><blockquote><p>"In practice it's often useful if developers commit more frequently than that. The more frequently you commit, the less places you have to look for conflict errors, and the more rapidly you fix conflicts."</p></blockquote><p>So taking this a basic rule of thumb, does Vincent's branching model conflict with continuous integration?  The short answer is no, so long as the developers are only branching locally and are pushing their changes to <em>origin</em> (the centralized git repository) daily.</p><p>In Vincent's approach however, he says</p><blockquote><p>"But besides the centralized push-pull relationships, each developer may also pull changes from other peers to form sub teams. For example, this might be useful to work together with two or more developers on a big new feature, before pushing the work in progress to <code>origin</code> prematurely."</p></blockquote><p>This is an approach to feature branching Martin Fowler calls <a title="Martin Fowler on Feature Branching " href="http://martinfowler.com/bliki/FeatureBranch.html" target="_blank">Promiscuous Integration</a>.  Martin Fowler attempts to assess whether the concept of promiscuous integration is a good idea or not.  I recommend you read the article yourself, but he ends up saying he thinks it's not the best idea (but doesn't outright say don't do it).  He recommends using <a title="Feature Toggles" href="http://martinfowler.com/bliki/FeatureToggle.html" target="_blank">Feature Toggles</a> or <a title="Branch by Abstraction" href="http://martinfowler.com/bliki/BranchByAbstraction.html" target="_blank">Branch by Abstraction</a> as approaches to avoiding Feature Branches in long running development cycles.  This same advice is reinforced in the book <a title="Continuous Delivery" href="http://www.amazon.com/Continuous-Delivery-Deployment-Automation-Addison-Wesley/dp/0321601912" target="_blank">Continuous Delivery</a> by <a title="Jez Humble" href="http://jezhumble.net/" target="_blank">Jez Humble</a> and <a title="Dave Farley" href="http://www.davefarley.net" target="_blank">Dave Farley</a>.  I highly recommend this book!</p><p>So, what does one do with this information?  Is use of GitFlow or promiscuous integration a bad idea?  I think that it can work very well for some teams and could be very dangerous in others.  In general, I like it when the VCS stays out of the way and the team gets in the habit of pushing changes and looking to the CI server validation that everything is ok.  Introducing promiscuous integration could interrupt this cycle and allow code changes to circumvention the mainline longer than they should.  This branching scheme feels complex, even with the addition of GitFlow.</p><p>I plan on trying GitFlow and further investigating it's merits, hopefully writting a more in depth analysis of how it works.  I think that it is an interesting idea (worth blogging about) and has a lot of potential.  I would love to hear what you think about GitFlow, promiscuous integration, feature branching and how they are good or bad, so please comment below!</p>