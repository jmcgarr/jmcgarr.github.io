<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Branching Problems with a Multi-Module Maven Project</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content"JBake">

    <!-- Le styles -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/asciidoctor.css" rel="stylesheet">
    <link href="/css/base.css" rel="stylesheet">
    <link href="/css/bootstrap-responsive.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="favicon.ico">
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-49993013-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  </head>
  <body>
    <div id="wrap">
	
	<!-- Fixed navbar -->
      <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="brand" href="/">Mike McGarr's Blog</a>
            <div class="nav-collapse collapse">
              <ul class="nav">
                <li><a href="/about.html">About</a></li>
                <li><a href="/archive.html">Blog</a></li>
                <li><a href="/feed.xml">Subscribe</a></li>
              </ul>
            </div><!--/.nav-collapse -->
          </div>
        </div>
      </div>
      <div class="container">	
	<div class="page-header">
		<h1>Branching Problems with a Multi-Module Maven Project</h1>
	</div>

	<p><em>16 February 2010</em></p>

	<p><p>I was impressed last year when I found that the <a href="http://m2eclipse.sonatype.org/" target="_blank">M2eclipse</a> <a href="http://www.eclipse.org/" target="_blank">Eclipse</a> plugin handled multi-module projects checked out of <a href="http://subversion.tigris.org/" target="_blank">Subversion</a> using <a href="http://subclipse.tigris.org/" target="_blank">Subclipse</a> with ease.  Eclipse does <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=35973" target="_blank">not natively support</a> a nested multi-module project structure <a href="http://maven.apache.org/guides/getting-started/index.html#How_do_I_build_more_than_one_project_at_once" target="_blank">recommended by Maven</a>, and getting the two to work well together has historically been a pain.  M2eclipse has solved this by "mapping" the child modules of the project you are importing to sibling projects in your Eclipse workspace.  For example, lets take the following multi-module Maven project:</p>
<p style="text-align:center;"><a href="http://earlyandoften.files.wordpress.com/2010/02/multimodelproject.png"></a><a href="http://earlyandoften.files.wordpress.com/2010/02/finder-view.png"></a><a href="http://earlyandoften.files.wordpress.com/2010/02/finder-view1.png"><img class="size-full wp-image-226 aligncenter" title="Project Structure." src="http://earlyandoften.files.wordpress.com/2010/02/finder-view1.png" alt="" width="164" height="154" /></a></p>
<p>This project consists of one parent project (springapp) which has four child modules (core, model, utility and webapp).  In the second image below, you can see that when this project is imported into Eclipse using M2eclipse, 5 projects have been created.  There is one project for each of the child modules and one for the parent project.  As you can see from the expanded view of parent module, it still includes the directories of the child modules, even though they are also contained in sibling projects in Eclipse.  This is only moderately confusing.</p>
<p style="text-align:center;"><a href="http://earlyandoften.files.wordpress.com/2010/02/eclipse-view.png"></a><a href="http://earlyandoften.files.wordpress.com/2010/02/eclipse-view1.png"></a><a href="http://earlyandoften.files.wordpress.com/2010/02/eclipse-view1.png"><img class="size-full wp-image-215 aligncenter" title="Project view from inside Eclipse" src="http://earlyandoften.files.wordpress.com/2010/02/eclipse-view1.png" alt="View of project from Eclipse." width="204" height="258" /></a></p>
<p>It has served us well and I haven't experienced any real issues until today.  As is common practice, I reached a point where I wanted take my work from the trunk and create a branch.  I had a bunch of working files not checked in, so I wanted to just create a branch right from my working directory.  There is this option in Subclipse to Branch/Tag (remember that in Subversion, the act of branching or tagging is essentially no different, both are simple copy commands to another directory).  So I went ahead and highlighted all Eclipse projects, right click on them and then choose the Branch/Tag option, following the wizard that walked me through the process.  When I was done and my code was branched, I felt pretty good, until I took a closer look at the code in the branch.</p>
<p style="text-align:center;"><a href="http://earlyandoften.files.wordpress.com/2010/02/subversion-view.png"><img class="size-full wp-image-222 aligncenter" title="Project Incorrectly Branched in Subversion" src="http://earlyandoften.files.wordpress.com/2010/02/subversion-view.png" alt="View of Subversion After bad Branching" width="203" height="421" /></a></p>
<p>If you compare the project structure in the trunk to the project structure in new-work-branch, focusing on the highlighted folder, you can see that something is amiss.  I checked in the 5 Eclipse projects as if they were separate modules of the springapp project instead of treating them like one project to check in.  Luckily I caught this before I did any real damage, although my solution was to remove the branch and start over again.  What I should have done was to select only the parent project when I started my branching effort, since the parent project in Eclipse encompasses all of the child projects as well.  Lesson learned!</p>
<p>While we could easily blame this problem on Maven for having a multi-module setup or even m2eclipse for allowing this happen, the truth is, the Eclipse platform should natively support hierarchical or nested project structures, like other IDE's do.  This has been a user request for some time, and with my experience today, I feel even more strongly about the need to make this change.</p>
</p>

	<hr>

	<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'mikemcgarr'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	
		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
        <p class="muted credit">&copy; 2013 | Mixed with <a href="http://twitter.github.com/bootstrap/">Bootstrap v2.3.1</a> | Baked with <a href="http://jbake.org">JBake v2.3.0-SNAPSHOT</a></p>
      </div>
    </div>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery-1.9.1.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/run_prettify.js"></script>
    
  </body>
</html>